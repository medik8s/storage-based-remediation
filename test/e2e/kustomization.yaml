apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization

# Set namespace for all resources
namespace: sbd-operator-system

# Include individual components to avoid webhook conflicts with OpenShift service-ca
resources:
- ../../config/crd
- ../../config/rbac
- ../../config/manager
- webhook-service.yaml
# Add e2e-specific webhook configuration that doesn't conflict with service-ca
- webhook-config.yaml

patches:
- path: image-pull-policy-patch.yaml
  target:
    kind: Deployment
    name: controller-manager
# [WEBHOOK] Enable webhook patch - local file to avoid kustomize security restrictions
- path: webhook-patch.yaml
  target:
    kind: Deployment
    name: controller-manager

#images:
#- name: controller:latest
#  newName: quay.io/medik8s/sbd-operator
#  newTag: latest
#- name: sbd-agent:latest
#  newName: quay.io/medik8s/sbd-agent
#  newTag: latest 