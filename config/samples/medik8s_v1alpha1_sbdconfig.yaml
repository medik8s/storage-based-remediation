# SBDConfig Sample Configuration
#
# This is a sample configuration for the SBD (STONITH Block Device) operator.
# The SBD operator provides watchdog-based fencing for Kubernetes clusters
# to ensure high availability through automatic node remediation.
#
# For comprehensive documentation, see: docs/sbdconfig-user-guide.md

apiVersion: medik8s.medik8s.io/v1alpha1
kind: SBDConfig
metadata:
  labels:
    app.kubernetes.io/name: sbd-operator
    app.kubernetes.io/managed-by: kustomize
  name: sbdconfig-sample
spec:
  # ========================================================================
  # WATCHDOG CONFIGURATION
  # ========================================================================
  
  # Path to the watchdog device on cluster nodes
  # - Default: "/dev/watchdog"
  # - Common alternatives: "/dev/watchdog0", "/dev/watchdog1"
  # - If hardware watchdog is not available, softdog will be used automatically
  # - All nodes should have the same watchdog device path
  # sbdWatchdogPath: "/dev/watchdog"
  
  # Watchdog timeout configuration for hardware/software watchdog device
  # - Default: "60s" (60 seconds)
  # - Range: "10s" to "300s" (5 minutes)
  # - Format: Go duration (e.g., "30s", "90s", "2m")
  # - This determines how long the system waits before triggering a reboot
  # - Hardware watchdogs may have device-specific limits
  # - Shorter timeouts: faster failure detection, more aggressive
  # - Longer timeouts: more conservative, handles temporary delays
  # 
  # Recommended values:
  # - Development/Testing: "30s" - "60s"
  # - Production (fast response): "60s" - "120s"
  # - Production (conservative): "120s" - "180s"
  watchdogTimeout: "60s"
  
  # Pet interval multiple for calculating watchdog pet frequency
  # - Default: 4 (pet interval = watchdog timeout / 4)
  # - Range: 3 to 20
  # - Higher values: less frequent petting, lower overhead
  # - Lower values: more frequent petting, higher safety margin
  # - Pet interval must be at least 3x shorter than watchdog timeout
  # 
  # With default 60s watchdog timeout:
  # - Multiple 3: pet every 20s (minimum safe)
  # - Multiple 4: pet every 15s (recommended)
  # - Multiple 6: pet every 10s (conservative)
  # - Multiple 10: pet every 6s (very conservative)
  petIntervalMultiple: 4
  
  # ========================================================================
  # CONTAINER IMAGE CONFIGURATION
  # ========================================================================
  
  # Container image for the SBD Agent DaemonSet
  # - Use specific version tags for production deployments
  # - Available images: quay.io/medik8s/sbd-agent:<version>
  # - For development: use "latest" tag
  # - For production: use specific version like "v1.0.0"
  image: "quay.io/medik8s/sbd-agent:latest"
  
  # Image pull policy for the SBD Agent container
  # - Always: Always pull the image, useful for development with "latest" tags
  # - IfNotPresent: Pull only if image not present locally (default, production-safe)
  # - Never: Never pull, only use local images
  # Default: "IfNotPresent" for production stability
  imagePullPolicy: "IfNotPresent"
  
  # ========================================================================
  # DEPLOYMENT CONFIGURATION
  # ========================================================================
  
  # Namespace where the SBD Agent DaemonSet will be deployed
  # - Default: "sbd-system"
  # - Namespace will be created if it doesn't exist
  # - Use different namespaces for multi-cluster environments
  namespace: "sbd-system"
  
  # ========================================================================
  # NODE LIFECYCLE CONFIGURATION
  # ========================================================================
  
  # Timeout for considering nodes stale and cleaning up their slot assignments
  # - Default: "1h" (1 hour)
  # - Range: "1m" to "24h"
  # - Format: Go duration (e.g., "30m", "2h", "90s")
  # - Shorter timeouts: faster slot cleanup, more aggressive
  # - Longer timeouts: more conservative, handles temporary network issues
  # 
  # Recommended values:
  # - Development/Testing: "5m" - "15m"
  # - Production (stable): "30m" - "2h"  
  # - Production (critical): "2h" - "6h"
  staleNodeTimeout: "1h"

# ========================================================================
# CONFIGURATION EXAMPLES
# ========================================================================
#
# Basic Production Configuration:
# --------------------------------
# spec:
#   image: "quay.io/medik8s/sbd-agent:latest"
#   namespace: "sbd-system"
#   staleNodeTimeout: "30m"
#
# High-Availability Configuration:
# --------------------------------
# spec:
#   image: "quay.io/medik8s/sbd-agent:latest"
#   sbdWatchdogPath: "/dev/watchdog1"
#   namespace: "high-availability"
#   staleNodeTimeout: "2h"
#
# Development/Testing Configuration:
# ----------------------------------
# spec:
#   image: "quay.io/medik8s/sbd-agent:latest"
#   namespace: "sbd-dev"
#   staleNodeTimeout: "5m"
#
# ========================================================================
# DEPLOYMENT COMMANDS
# ========================================================================
#
# Apply configuration:
#   kubectl apply -f medik8s_v1alpha1_sbdconfig.yaml
#
# Check status:
#   kubectl get sbdconfig
#   kubectl describe sbdconfig sbdconfig-sample
#
# Monitor deployment:
#   kubectl get pods -n sbd-system
#   kubectl logs -n sbd-system -l app=sbd-agent
#
# ========================================================================